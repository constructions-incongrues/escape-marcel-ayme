name: Build and Deploy
on: [push]
permissions: 
  contents: write
jobs:
  build-and-deploy:
    concurrency: ci-${{ github.ref }} # Recommended if you intend to make multiple deployments in quick succession.
    runs-on: ubuntu-latest
    steps:
      - name: Checkout ğŸ›ï¸
        uses: actions/checkout@v3
      - name: Deploy ğŸš€
        uses: JamesIves/github-pages-deploy-action@v4.3.3
        with:
          branch: main
          folder: .

  notification:
    name: Rocket.Chat Notifications
    runs-on: ubuntu-latest
    steps:
      - uses: RocketChat/Rocket.Chat.GitHub.Action.Notification@1.1.1
      - name: with mention on failure only
        uses: ./
        with:
          type: ${{ job.status }}
          job_name: ':robot_face: *Success no mention*'
          mention: 'here'
          mention_if: 'failure'
          commit: true
          url: ${{ secrets.ROCKETCHAT_WEBHOOK }}
